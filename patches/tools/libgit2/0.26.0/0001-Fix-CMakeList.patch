diff -Naur a/CMakeLists.txt b/CMakeLists.txt
--- a/CMakeLists.txt	2017-06-14 14:31:20.000000000 +0300
+++ b/CMakeLists.txt	2017-10-05 17:54:16.076806087 +0300
@@ -50,9 +50,12 @@
 ENDIF()
 
 IF(${CMAKE_SYSTEM_NAME} MATCHES "Darwin")
-	SET( USE_ICONV ON )
-	FIND_PACKAGE(Security)
-	FIND_PACKAGE(CoreFoundation REQUIRED)
+	#:SET( USE_ICONV ON )
+        #:FIND_PACKAGE(Security)
+	#:FIND_PACKAGE(CoreFoundation REQUIRED)
+        SET(COREFOUNDATION_FOUND TRUE)
+        SET(COREFOUNDATION_INCLUDE_DIR "${CREW_ISYSROOT}/System/Library/Frameworks/CoreFoundation.framework/Headers")
+        SET(COREFOUNDATION_DIRS "${CREW_ISYSROOT}/System/Library/Frameworks/CoreFoundation.framework")
 ENDIF()
 
 IF(MSVC)
@@ -276,18 +279,22 @@
 	LINK_LIBRARIES(winhttp rpcrt4 crypt32 ole32)
 	LIST(APPEND LIBGIT2_PC_LIBS "-lwinhttp" "-lrpcrt4" "-lcrypt32" "-lole32")
 ELSE ()
-	IF (CURL)
-		PKG_CHECK_MODULES(CURL libcurl)
-	ENDIF ()
+	#:IF (CURL)
+	#:	PKG_CHECK_MODULES(CURL libcurl)
+	#:ENDIF ()
 
 	IF (NOT AMIGA AND USE_OPENSSL)
 		FIND_PACKAGE(OpenSSL)
 	ENDIF ()
 
-	IF (CURL_FOUND)
+        #:
+        SET(CURL_FOUND TRUE)
+        SET(CURL_LIBRARIES "${CREW_LIB_DIR}/libcurl.${CREW_SHARED_LIB_EXT}")
+        SET(CURL_LDFLAGS "-lcurl")
+        IF (CURL_FOUND)
 		ADD_DEFINITIONS(-DGIT_CURL)
-		INCLUDE_DIRECTORIES(${CURL_INCLUDE_DIRS})
-		LINK_DIRECTORIES(${CURL_LIBRARY_DIRS})
+		#:INCLUDE_DIRECTORIES(${CURL_INCLUDE_DIRS})
+		#:LINK_DIRECTORIES(${CURL_LIBRARY_DIRS})
 		LINK_LIBRARIES(${CURL_LIBRARIES})
 		LIST(APPEND LIBGIT2_PC_LIBS ${CURL_LDFLAGS})
 	ENDIF()
@@ -357,18 +364,24 @@
 ENDIF()
 
 # Optional external dependency: libssh2
-IF (USE_SSH)
-	PKG_CHECK_MODULES(LIBSSH2 libssh2)
-ENDIF()
+#:IF (USE_SSH)
+#:	PKG_CHECK_MODULES(LIBSSH2 libssh2)
+#:ENDIF()
+
+SET(LIBSSH2_FOUND TRUE)
+SET(LIBSSH2_LIBRARIES "${CREW_LIB_DIR}/libssh2.${CREW_SHARED_LIB_EXT}")
+SET(LIBSSH2_LDFLAGS "-lssh2")
+
 IF (LIBSSH2_FOUND)
 	ADD_DEFINITIONS(-DGIT_SSH)
-	INCLUDE_DIRECTORIES(${LIBSSH2_INCLUDE_DIRS})
-	LINK_DIRECTORIES(${LIBSSH2_LIBRARY_DIRS})
+	#:INCLUDE_DIRECTORIES(${LIBSSH2_INCLUDE_DIRS})
+	#:LINK_DIRECTORIES(${LIBSSH2_LIBRARY_DIRS})
 	LIST(APPEND LIBGIT2_PC_LIBS ${LIBSSH2_LDFLAGS})
 	#SET(LIBGIT2_PC_LIBS "${LIBGIT2_PC_LIBS} ${LIBSSH2_LDFLAGS}")
 	SET(SSH_LIBRARIES ${LIBSSH2_LIBRARIES})
 
-	CHECK_LIBRARY_EXISTS("${LIBSSH2_LIBRARIES}" libssh2_userauth_publickey_frommemory "${LIBSSH2_LIBRARY_DIRS}" HAVE_LIBSSH2_MEMORY_CREDENTIALS)
+        #:
+	CHECK_LIBRARY_EXISTS("${LIBSSH2_LIBRARIES}" libssh2_userauth_publickey_frommemory "${CREW_LIB_DIR}" HAVE_LIBSSH2_MEMORY_CREDENTIALS)
 	IF (HAVE_LIBSSH2_MEMORY_CREDENTIALS)
 		ADD_DEFINITIONS(-DGIT_SSH_MEMORY_CREDENTIALS)
 	ENDIF()
