#!/bin/bash

unset GEM_HOME
unset GEM_PATH

CREW_FILE_DIR=$(dirname $0)
CREW_RUBY_VERSION="2.2.0"

if [ -z $CREW_BASE_DIR ]; then
    CREW_BASE_DIR="$CREW_FILE_DIR"
fi

if [ -z $CREW_DOWNLOAD_BASE ]; then
    CREW_DOWNLOAD_BASE="https://crew.crystax.net:9876"
fi

if [ -z $CREW_NDK_DIR ]; then
    CREW_NDK_DIR="../$CREW_FILE_DIR"
fi

if [ -z $CREW_TOOLS_DIR ]; then
    CREW_TOOLS_DIR="$CREW_NDK_DIR/tools"
fi

if [ -z $CREW_RUBY_DIR ]; then
    CREW_RUBY_DIR="$CREW_TOOLS_DIR/ruby"
fi

GIT_EXEC_PATH="$CREW_TOOLS_DIR/git/libexec/git-core"

export CREW_BASE_DIR CREW_DOWNLOAD_BASE CREW_NDK_DIR CREW_TOOLS_DIR CREW_RUBY_DIR
export GIT_EXEC_PATH

exec $CREW_RUBY_DIR/ruby -W0 "$CREW_FILE_DIR/crew.rb" "$@"
